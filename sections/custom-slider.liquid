<section id="slider-{{ section.id }}" class="relative overflow-hidden">

    <div class="flex transition-transform duration-700 ease-in-out slides">

        {% for block in section.blocks %}
        <div class="relative min-w-full">

            {% if block.settings.image != blank %}
            <img src="{{ block.settings.image | image_url: width: 1800 }}" class="w-full h-[480px] object-cover" alt="">
            {% else %}
            {{ 'lifestyle-2' | placeholder_svg_tag }}
            {% endif %}

            <div
                class="absolute inset-0 flex flex-col justify-center px-16 text-white bg-gradient-to-r from-black/70 to-transparent">
                <h2 class="text-4xl font-bold">{{ block.settings.title }}</h2>
                <p class="max-w-lg my-3 opacity-90">{{ block.settings.text }}</p>

                {% if block.settings.button_link != blank %}
                <a href="{{ block.settings.button_link }}"
                    class="py-3 font-semibold text-black transition bg-white rounded-full px-7 w-fit hover:bg-black hover:text-white">
                    {{ block.settings.button_text }}
                </a>
                {% endif %}
            </div>

        </div>
        {% endfor %}

    </div>

    <div class="absolute flex gap-2 -translate-x-1/2 bottom-4 left-1/2 dots"></div>

</section>

<script>
    (function () {
        const slider = document.querySelector("#slider-{{ section.id }}");
        const slides = slider.querySelector(".slides");
        const slideCount = slides.children.length;
        const dotsBox = slider.querySelector(".dots");
        let index = 0;

        for (let i = 0; i < slideCount; i++) {
            const dot = document.createElement("span");
            if (i == 0) dot.classList.add("active");
            dot.onclick = () => go(i);
            dotsBox.appendChild(dot);
        }

        const dots = dotsBox.children;

        function go(i) {
            index = i;
            slides.style.transform = `translateX(-${i * 100}%)`;
            [...dots].forEach(d => d.classList.remove("active"));
            dots[i].classList.add("active");
        }

        setInterval(() => {
            index = (index + 1) % slideCount;
            go(index);
        }, 4000);
    })();
</script>

{% schema %}
{
"name": "Modern Slider",
"blocks": [
{
"type": "slide",
"name": "Slide",
"settings": [
{
"type":"image_picker",
"id":"image","label":"Image"
},
{
"type":"text",
"id":"title",
"label":"Title",
"default":"New Collection"
},
{
"type":"textarea",
"id":"text",
"label":"Description"
},
{
"type":"text",
"id":"button_text",
"label":"Button Text",
"default":"Shop Now"
},
{
"type":"url",
"id":"button_link",
"label":"Button Link"
}
]
}
],
"presets": [
{
"name": "Modern Slider"
}
]
}
{% endschema %}