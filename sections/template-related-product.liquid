{% if product.collections.size > 0 %}
{% assign related_collection = product.collections.first %}
{% else %}
{% assign related_collection = collections.all %}
{% endif %}

<section class="px-6 py-12 mx-auto max-w-7xl">
  <h2 class="mb-6 text-2xl font-bold">
    {{ section.settings.heading }}
  </h2>

  <div class="grid grid-cols-2 gap-6 md:grid-cols-4">

    {% for product in related_collection.products limit: section.settings.limit %}
    {% unless product.id == product.id %}
    <div class="overflow-hidden transition border rounded-lg hover:shadow-lg">

      <a href="{{ product.url }}">
        <img src="{{ product.featured_image | image_url: width: 500 }}" alt="{{ product.title }}"
          class="object-cover w-full h-60">
      </a>

      <div class="p-4">
        <h3 class="mb-1 text-sm font-medium">
          {{ product.title }}
        </h3>

        <p class="text-sm font-semibold">
          {{ product.price | money }}
        </p>

        <a href="{{ product.url }}" class="inline-block mt-3 text-sm text-blue-600 hover:underline">
          View Product
        </a>
      </div>

    </div>
    {% endunless %}
    {% endfor %}

  </div>
</section>

{% schema %}
{
"name": "Related Products",
"settings": [
{
"type": "text",
"id": "heading",
"label": "Heading",
"default": "Related Products"
},
{
"type": "range",
"id": "limit",
"label": "Number of products",
"min": 2,
"max": 8,
"step": 1,
"default": 4
}
],
"presets": [
{
"name": "Related Products"
}
]
}
{% endschema %}