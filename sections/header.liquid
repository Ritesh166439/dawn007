<div class="relative bg-white">
  <div class="px-4 mx-auto sm:px-6">
    <div class="flex items-center justify-between py-6 md:justify-start md:space-x-10">
      <!-- store name -->
      <div class="flex justify-center truncate lg:flex-1">
         {% if section.settings.logo_image %}
          <img class="text-xl font-bold truncate"
          src="{{ section.settings.logo_image | img_url: 'small' }}"
          alt="{{ section.settings.logo_image.alt | escape }}"
        >
        {% else %}
          <a href="{{ shop.url }}" class="text-lg font-bold text-gray-900 hover:text-gray-700">
            {{ shop.name }}
          </a>    
        {% endif %}
      </div>
      <div class="ml-3 -my-2 -mr-2 md:hidden">
        <button class="inline-flex items-center justify-center p-2 bg-white focus:outline-none">
          {% render 'icon-menu' %}
        </button>
      </div>
      
      <!-- Navigation Menu -->
      <div class="hidden space-x-10 md:flex">
        {% for link in section.settings.menu.links %}
          {% if link.links == blank %}
            <div class="relative" x-data="{ open: false }">
              <button  x-on:click ="{open = !open}" class="inline-flex items-center">
                {{ link.title }}
                {% render 'icon-dropdown' %}
              </button>
              <div 
              x-transition:enter="transition ease-out duration-300"
              x-transition:enter-start="opacity-0 translate-y-3"
              x-transition:enter-end="opacity-100 translate-y-0"
              x-show="open" @click.away="open = false"
              class="absolute z-10 w-screen px-2 -ml-5 transform mx-w-md sm:px-0 lg:ml-0 lg:left-1/2 lg:-translate-x-1/2">
                <div class="overflow-hidden rounded-lg shadow-lg-border ring-black ring-opacity-5">
                  <div class="relative grid gap-6">
                    <div class="absolute inset-0 gap-8 p-8 px-5 py-6 bg-white sm:px-8 sm:p-8">
                      {% for childlink in link.links %}
                        <a href="{{ childlink.url }}" class="flex items-start p-3 -m-3 rounded-lg hover:bg-gray-100">
                          <div class="ml-4">
                            <p class="text-base font-medium text-gray-900">{{ childlink.title }}</p>
                          </div>
                          </a>
                  {% endfor %}
                    </div>
                  </div>
                  
                </div>
              </div>

            </div>
          {% else %}
            <a href="{{ link.url }}" class="text-base text-gray-500 hover:text-gray-500">{{ link.title }}</a>
          {% endif %}
        {% endfor %}
      </div>
      <!-- Cart button / account link if enabled -->
      <div class="items-center justify-center hidden space-x-5 md:flex flex-end md:flex-1">
        <a href="/cart" class="text-base text-gray-500 whitespace-nowrap hover:text-gray-900">
          {% render 'icon-shopping-bag' %}
        </a>
        
        {% if shop.customer_accounts_enabled %}
          {% if customer %}
            <a href="/account">account</a>
            {{'logout' |  customer_logout_link | replace: '<a', '<a class="text-base text-gray-500 hover:text-gray-900"' }}

          {% else %}
            {{'login' |  customer_login_link | replace: '<a', '<a class="text-base text-gray-500 hover:text-gray-900"' }}
            {% comment %} {{'register' |  customer_register_link | replace: '<a', '<a class="text-base text-gray-500 hover:text-gray-900"' }} {% endcomment %}


          {% endif %}

          {% endif %}
      </div>
      {% render 'header-search', input_id: 'Search-In-Modal' %}

      {%- if shop.customer_accounts_enabled -%}
        <a
          href="{%- if customer -%}{{ routes.account_url }}{%- else -%}{{ routes.account_login_url }}{%- endif -%}"
          class="header__icon header__icon--account link focus-inset{% if section.settings.menu != blank %} small-hide{% endif %}"
          rel="nofollow"
        >
          {%- if section.settings.enable_customer_avatar -%}
            <account-icon>
              {%- if customer and customer.has_avatar? -%}
                {{ customer | avatar }}
              {%- else -%}
                <span class="svg-wrapper">{{ 'icon-account.svg' | inline_asset_content }}</span>
              {%- endif -%}
            </account-icon>
          {%- else -%}
            <span class="svg-wrapper">{{ 'icon-account.svg' | inline_asset_content }}</span>
          {%- endif -%}
          <span class="visually-hidden">
            {%- liquid
              if customer
                echo 'customer.account_fallback' | t
              else
                echo 'customer.log_in' | t
              endif
            -%}
          </span>
        </a>
      {%- endif -%}

      {%- for block in section.blocks -%}
        {%- case block.type -%}
          {%- when '@app' -%}
            {% render block %}
        {%- endcase -%}
      {%- endfor -%}

      <a href="{{ routes.cart_url }}" class="header__icon header__icon--cart link focus-inset" id="cart-icon-bubble">
        {% if cart == empty %}
          <span class="svg-wrapper">{{ 'icon-cart-empty.svg' | inline_asset_content }}</span>
        {% else %}
          <span class="svg-wrapper">{{ 'icon-cart.svg' | inline_asset_content }}</span>
        {% endif %}
        <span class="visually-hidden">{{ 'templates.cart.cart' | t }}</span>
        {%- if cart != empty -%}
          <div class="cart-count-bubble">
            {%- if cart.item_count < 100 -%}
              <span aria-hidden="true">{{ cart.item_count }}</span>
            {%- endif -%}
            <span class="visually-hidden">{{ 'sections.header.cart_count' | t: count: cart.item_count }}</span>
          </div>
        {%- endif -%}
      </a>
    </div>
</div>

{% schema %}
{
  "name": "header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo_image",
      "label": "Logo"
    },
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "Navigation Menu"
    },
    {
      "type": "inline_richtext",
      "id": "paragraph",
      "label": "Text text"
    },
    
    {
      "type": "image_picker",
      "id": "image",
      "label": "upload image"
    }

  ],
  "blocks": [
   
  ],
  "presets": [
    {
      "name": "Header",
      "category": "Header"
    }
  ]
}
{% endschema %}
